# 最近的折腾

### 前言
软路由之前就入手了两个，秉持着又不是不能用的态度，没怎么深度折腾过。直到一个月前，入手了一台MINISFORUM，来代替掉我那台从2012年就上岗工作至今的T430，开始了各种折腾，先后又入手了wifi6无线路由、UPS、电视棒。到现在一个月的时间，已经告一段落，就总结一下。

### 折腾
![network](https://github.com/demondevilhades/doc/blob/main/2021-03-04_network/network_2021-03.jpg?raw=true "有图有真相")  
按时间讲  
 1. MINISFORUM型号是UM700，CPU是AMD-3750H。想入3550那款，没货了，也不想等了。对硬件也不怎么了解，对比来对比去就还是这款吧，功率不算高，性能也足够。到货之后开机直接刷上了PVE，然后装的Ubuntu。linux这些年的生态发展的其实不错，我需要的软件基本都能满足了，况且一上手docker真停不下来，镜像pull下来直接跑，免去了对环境的污染，还极大地方便了使用和管理。之后把旧电脑的机械硬盘拆下来也加到了里面，PVE格式化了硬盘直接挂载，nfs共享。为了让Ubuntu比较干净，坏了或者换了系统也能快速使用，整理了一份脚本，目标是基本达到新系统一键配置。之前没用过PVE，装Ubuntu的时候很多配置都是默认的，硬盘分配了大概200G。PVE通过nfs共享硬盘之后，把Ubuntu重装了，硬盘分配了32G，CPU模式换成了host，之后硬盘不够的话就挂载吧，还能内网共享，也不麻烦。主要应用都在docker里面，系统配置和docker容器的配置保存一份，新装系统也能快速达到可用的状态，再也不愁换系统了。
 2. Main Route用的是tplink的wifi6路由器，Secondary Route用的是软路由newifi，刷好的openwrt。最理想的方式当然是LAN 2 LAN，软路由做旁路由。但是搞了一个晚上没搞好，软路由都重启了几十次，索性算了。tplink当主路由，新版本的后台居然连静态路由配置都没了，以后不会再入手tplink的路由了，确实太封闭功能太少。不过目前的方式，虽然两台路由不在同一个子网段，Secondary Route下的设备到Main Route下的设备只能单向连通，但是访问上暂时也没什么需求，有的话也能通过软路由配置，也先不折腾了。
 3. nas这事单独说一下吧。有钱的话直接群晖或者威联通。想自己折腾的话……也看了不少帖子，打消了这个念头。这个东西能折腾的相当多，但是越想现在越没有那么大的动力，需求也没有那么大。虽然入了一个UPS，先给MINISFORUM用着。手里移动硬盘也一堆了，软路由插上移动硬盘也能直接内网共享。等真的再有动力在上吧。倒是UPS用上第二天，楼层就停了次电，大概十几分钟吧。停电的时候UPS会有蜂鸣声，半夜里停电的话大概可能会影响睡觉吧，以后使用过程中再优化apcupsd的参数。
 4. 电视棒入的是Chromecast，确实是个好东西。自从高中住校以来，告别电视多少年了，有了它终于找回了一点看电视的感觉。ytb，Netflix，kodi三驾马车。躺在床上，视频网站、流媒体、内网共享全都遥控器解决，那确实是比电脑看上爽多了。也是不想被开机广告之类的东西恶心吧。
 5. 本来已经搞得差不多了，在tplink里面发现了可以配置DDNS，但是是真没用。境内的话花生壳提供了付费的nat-ddns服务。还在观望的时候就发现了其实也是有一些平台提供nat/frp-ddns服务的，免费的也能够有一些隧道和流量，又继续搞起。github上的frp有43k+的star，不少三方的服务也是基于这个提供的。又是直接docker容器做客户端，然后再起一个nginx的docker把内网资源都映射到同一个端口的不同path上。反正也不是为了公网上看家里存的视频之类的，能够偶尔管理一下家里的关键设备就可以了。
 
硬件花费就是图上的这些，订阅的话，机场一年不到100CNY先用着，Netflix包月15CNY，也没有其他的了。  
网络这部分应该基本到此为止了，折腾了一个月。折腾完了还算省心。先享受享受，学点其他的东西，等什么时候来劲了再继续回来搞。  
